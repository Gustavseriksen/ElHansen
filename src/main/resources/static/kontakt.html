<!DOCTYPE html>
<html lang="da">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>Kontakt EL-Hansen</title>

  <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
  <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/bootstrap-icons@1.11.0/font/bootstrap-icons.css">
  <link rel="stylesheet" href="/css/style.css">
</head>
<body>

<div class="sticky-top bg-white shadow-sm border-bottom mb-4">
  <div class="container-fluid px-4">
    <header class="d-flex flex-wrap justify-content-center py-3">
      <a href="index.html" class="d-flex align-items-center mb-3 mb-md-0 me-md-auto link-body-emphasis text-decoration-none">
        <span class="fs-4 fw-bold">EL–Hansen</span>
      </a>

      <ul class="nav nav-pills">
        <li class="nav-item"><a href="ydelser.html" class="nav-link">Ydelser</a></li>
        <li class="nav-item"><a href="prisestimat.html" class="nav-link">Prisestimat</a></li>
        <li class="nav-item"><a href="kontakt.html" class="nav-link">Kontakt</a></li>
        <li class="nav-item"><a href="om.html" class="nav-link">Om</a></li>
      </ul>
    </header>
  </div>
</div>

<div class="container py-5">
  <div class="row g-5">

    <div class="col-md-5 col-lg-4 order-md-last">
      <ul class="list-group mb-3">

        <li class="list-group-item d-flex justify-content-between lh-sm">
          <div>
            <h6 class="my-0"><i class="bi bi-geo-alt-fill me-2"></i>Adresse</h6>
            <small class="text-body-secondary" id="infoAdresse" style="white-space: pre-line;">Henter adresse...</small>
          </div>
        </li>

        <li class="list-group-item d-flex justify-content-between lh-sm">
          <div>
            <h6 class="my-0"><i class="bi bi-telephone-fill me-2"></i>Telefon</h6>
            <small class="text-body-secondary" id="infoTlf">...</small>
          </div>
        </li>

        <li class="list-group-item d-flex justify-content-between lh-sm">
          <div>
            <h6 class="my-0"><i class="bi bi-clock-fill me-2"></i>Åbningstider</h6>
            <small class="text-body-secondary" id="infoTid" style="white-space: pre-line;">...</small>
          </div>
        </li>

      </ul>
    </div>

    <div class="col-md-7 col-lg-8">
      <h4 class="mb-3">Send en henvendelse</h4>
      <form id="contactForm" class="needs-validation" novalidate>
        <div class="row g-3">

          <div class="col-12">
            <label for="fullName" class="form-label">Navn</label>
            <input type="text" class="form-control" id="fullName" placeholder="F.eks. Jens Jensen" required>
          </div>

          <div class="col-sm-6">
            <label for="email" class="form-label">E-mail</label>
            <input type="email" class="form-control" id="email" placeholder="mail@eksempel.dk" required>
          </div>

          <div class="col-sm-6">
            <label for="phone" class="form-label">Telefonnummer</label>
            <input type="tel" class="form-control" id="phone" placeholder="+45 12 34 56 78" required>
          </div>

          <div class="col-md-4">
            <label for="zip" class="form-label">Postnummer</label>
            <input type="text" class="form-control" id="zip" placeholder="2200" required>
          </div>

          <div class="col-12">
            <label for="message" class="form-label">Beskriv opgaven</label>
            <textarea class="form-control" id="message" rows="5" placeholder="Hvad skal du have lavet?" required></textarea>
          </div>

        </div>

        <hr class="my-4">

        <button class="w-100 btn btn-warning btn-lg" type="submit" id="submitBtn">Send henvendelse</button>
      </form>
    </div>
  </div>
</div>

<div class="container">
  <footer class="d-flex flex-wrap justify-content-between align-items-center py-3 my-4 border-top">
    <p class="col-md-4 mb-0 text-body-secondary">© 2025 EL-Hansen ApS</p>

    <ul class="nav col-md-4 justify-content-end">
      <li class="nav-item"><a href="om.html" class="nav-link px-2 text-body-secondary">Om</a></li>
      <li class="nav-item"><a href="kontakt.html" class="nav-link px-2 text-body-secondary">Kontakt</a></li>
    </ul>
  </footer>
</div>

<script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>

<script>
  // --- 1. SEND BESKED (Formular) ---
  const SAGER_API = "http://localhost:8080/api/sager";

  document.getElementById("contactForm").addEventListener("submit", async function(event) {
    event.preventDefault(); // Stop siden fra at reloade

    // Hent værdier
    const fullName = document.getElementById("fullName").value;
    const email = document.getElementById("email").value;
    const phone = document.getElementById("phone").value;
    const zip = document.getElementById("zip").value;
    const message = document.getElementById("message").value;

    // Validering
    if (!fullName || !email || !message) {
      alert("Udfyld venligst alle felter.");
      return;
    }

    // Deaktiver knap
    const btn = document.getElementById("submitBtn");
    btn.disabled = true;
    btn.innerText = "Sender...";

    // Byg objekt
    const sagObj = {
      kundeNavn: fullName,
      kundeEmail: email,
      kundeTlf: phone,
      adresse: zip,
      beskrivelse: message,
      overskrift: "Henvendelse fra " + fullName,
      status: "NY"
    };

    try {
      const response = await fetch(SAGER_API, {
        method: "POST",
        headers: { "Content-Type": "application/json" },
        body: JSON.stringify(sagObj)
      });

      if (response.ok) {
        alert("Tak for din henvendelse! Holger vender tilbage hurtigst muligt.");
        document.getElementById("contactForm").reset();
      } else {
        alert("Der opstod en fejl ved afsendelse. Prøv igen.");
      }
    } catch (error) {
      console.error("Fejl:", error);
      alert("Kunne ikke forbinde til serveren.");
    } finally {
      btn.disabled = false;
      btn.innerText = "Send henvendelse";
    }
  });

  // --- 2. HENT KONTAKTINFO (Stamdata) ---
  const INFO_API = "http://localhost:8080/api/kontaktinfo";

  document.addEventListener("DOMContentLoaded", async () => {
    try {
      const response = await fetch(INFO_API);
      const data = await response.json();

      // Sæt teksten ind i HTML elementerne
      document.getElementById("infoAdresse").innerText = data.adresse || "Ingen adresse";
      document.getElementById("infoTlf").innerText = data.telefon || "Ingen tlf";
      document.getElementById("infoTid").innerText = data.aabningstider || "Lukket";

    } catch(e) { console.error("Kunne ikke hente kontaktinfo", e); }
  });
</script>

</body>
</html>